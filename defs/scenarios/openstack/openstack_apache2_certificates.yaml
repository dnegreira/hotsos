checks:
  ssl-enabled:
    requires: 
      property: hotsos.core.plugins.openstack.OpenstackBase.ssl_enabled
  apache2-certificate-expiring:
    requires:
      property: hotsos.core.plugins.openstack.OpenstackBase.apache2_certificates_expiring
      op: ne
      value: []
conclusions:
  need-certificate-renewal:
    decision:
      and:
        - ssl-enabled
        - apache2-certificate-expiring
    raises:
      type: hotsos.core.issues.OpenstackWarning
      message: >-
        The following certificates will expire in less than 60 days:
        {apache2-certificates-path}
      format-dict:
        apache2-certificates-path: '@hotsos.core.plugins.openstack.OpenstackBase.apache2_certificates_expiring'
